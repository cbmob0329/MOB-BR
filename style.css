/* style.css
   - main.png (1347x2048) を基準に「縦長ステージ」をレスポンシブで表示
   - その上に透明ボタン(hit)を重ねる
   - Hキーで hitbox 可視化（body.hit-debug）
*/

:root{
  --stage-w: 1347;
  --stage-h: 2048;
  --stage-ratio: calc(var(--stage-w) / var(--stage-h)); /* 1347/2048 */
  --safe-pad: env(safe-area-inset-top, 0px);
  --safe-pad-b: env(safe-area-inset-bottom, 0px);
}

*{ box-sizing:border-box; }

html, body{
  height:100%;
  margin:0;
  padding:0;
  background:#000; /* 余白が出ても黒で統一 */
  -webkit-tap-highlight-color: transparent;
}

body{
  overflow:hidden; /* ステージは固定表示 */
  touch-action: manipulation;
  user-select:none;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
}

/* 画面ルート */
#app{
  position:relative;
  width:100%;
  height:100%;
  padding-top: var(--safe-pad);
  padding-bottom: var(--safe-pad-b);
  display:flex;
  align-items:center;
  justify-content:center;
}

/* 画面（main / map など） */
.screen{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
}

.screen.is-active{
  display:flex;
}

/* ステージ
   - 1347x2048 の縦長比率を維持
   - 画面に収まる最大サイズにスケール
*/
.stage{
  position:relative;
  height: min(100dvh, calc(100vh - var(--safe-pad) - var(--safe-pad-b)));
  width: calc(height * var(--stage-ratio)); /* 一部ブラウザで効かないので下で補完 */
  max-height: calc(100vh - var(--safe-pad) - var(--safe-pad-b));
  aspect-ratio: var(--stage-w) / var(--stage-h);
  overflow:hidden;
  background:#000;
}

/* aspect-ratio未対応の保険 */
@supports not (aspect-ratio: 1 / 1){
  .stage{
    width: min(100vw, calc((100vh - var(--safe-pad) - var(--safe-pad-b)) * (1347/2048)));
  }
}

/* ステージ画像 */
.stage-img{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain; /* ここ重要：比率を崩さない */
  object-position:center;
  image-rendering:auto;
  display:block;
  pointer-events:none; /* ボタンが押せるように */
}

/* 透明ボタン */
.hit{
  position:absolute;
  border:0;
  padding:0;
  margin:0;
  background:transparent;
  cursor:pointer;
  pointer-events:auto;
  /* スマホで押しやすく */
  touch-action: manipulation;
}

/* フォーカス（キーボード操作時） */
.hit:focus-visible{
  outline: 3px solid rgba(255,255,255,0.8);
  outline-offset: 2px;
  border-radius: 10px;
}

/* 当たり判定デバッグ表示（Hキー） */
body.hit-debug .hit{
  background: rgba(0, 200, 255, 0.18);
  outline: 2px solid rgba(0, 200, 255, 0.8);
  box-shadow: 0 0 0 2px rgba(0,0,0,0.2) inset;
}

/* ui.js が生成する要素用（最低限の見た目）
   ※あなたの最終UIではここを好きに変えてOK
*/
#hud{
  position:fixed;
  left:12px;
  top:12px;
  z-index:9999;
  color:#fff;
  background:rgba(0,0,0,0.55);
  padding:10px 12px;
  border-radius:10px;
  font-size:13px;
  pointer-events:none;
}

#logBox{
  position:fixed;
  left:12px;
  bottom:12px;
  z-index:9999;
  width:min(560px, calc(100vw - 24px));
  max-height:34vh;
  overflow:auto;
  color:#fff;
  background:rgba(0,0,0,0.55);
  padding:10px 12px;
  border-radius:10px;
  font-size:12px;
  line-height:1.35;
  pointer-events:auto;
}

#resultWrap{
  position:relative;
  z-index:5;
  width:min(980px, calc(100vw - 24px));
  max-height: calc(100vh - 24px - var(--safe-pad) - var(--safe-pad-b));
  overflow:auto;
  background:rgba(255,255,255,0.96);
  border-radius:14px;
  padding:12px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.35);
}

#modal{
  position:fixed;
  inset:0;
  z-index:10000;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.6);
}

#modalInner{
  max-width:min(680px, calc(100vw - 40px));
  max-height:min(70vh, calc(100vh - 40px));
  overflow:auto;
  background:rgba(20,20,20,0.92);
  color:#fff;
  padding:14px 16px;
  border-radius:12px;
}
