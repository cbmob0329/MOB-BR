:root{
  --bg:#0b0b0f;
  --panel:#13131b;
  --panel2:#171723;
  --line:#2a2a3a;
  --txt:#f1f1f7;
  --muted:#b6b6c8;
  --accent:#7cffd2;
  --accent2:#7bb7ff;
  --danger:#ff5a6a;
  --gold:#ffd36b;

  --radius:14px;
  --shadow:0 12px 28px rgba(0,0,0,.45);

  --w:420px;
  --h:560px;
  --safe: env(safe-area-inset-bottom, 0px);
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0;
  background: radial-gradient(1200px 700px at 50% 0%, #1a1a2b 0%, var(--bg) 55%, #07070a 100%);
  color:var(--txt);
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
  overflow:hidden;
}

img{
  max-width:100%;
  display:block;
}

.mono{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
}

#app{
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  padding:10px 10px calc(10px + var(--safe));
  gap:10px;
}

/* =========================
   HUD
========================= */
.hud{
  width: min(96vw, calc(var(--w) + 24px));
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.08);
  box-shadow: var(--shadow);
  border-radius: var(--radius);
  padding:10px 12px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
}

.hud-left, .hud-right{
  display:flex;
  flex-direction:column;
  gap:6px;
}

.hud-line{
  display:flex;
  align-items:baseline;
  gap:8px;
  line-height:1.0;
}

.label{
  color:var(--muted);
  font-size:12px;
  letter-spacing:.02em;
}

.value{
  font-size:14px;
  font-weight:800;
}

/* =========================
   Stage
========================= */
#stage{
  width: min(96vw, calc(var(--w) + 24px));
  flex:1;
  display:flex;
  align-items:center;
  justify-content:center;
}

.screen{
  width: min(96vw, calc(var(--w) + 24px));
  max-width: calc(var(--w) + 24px);
  height: calc(var(--h) + 24px);
  max-height: min(70vh, calc(var(--h) + 24px));
  display:none;
}

.screen.is-active{
  display:block;
}

.screen-inner{
  width:100%;
  height:100%;
  border-radius: var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.10);
  box-shadow: var(--shadow);
  overflow:hidden;
  position:relative;
}

.screen-inner.center{
  display:flex;
  align-items:center;
  justify-content:center;
}

/* =========================
   Background image display
========================= */
.bg-image{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  user-select:none;
  -webkit-user-drag:none;
}

/* =========================
   Hotspots (transparent buttons)
========================= */
.hotspots{
  position:absolute;
  inset:0;
  pointer-events:none; /* 個別ボタンだけonにする */
}

.hotspot{
  position:absolute;
  pointer-events:auto;
  border-radius:10px;
  background:rgba(124,255,210,.00); /* 完全透明 */
  border:1px solid rgba(124,255,210,.00);
  transition:.12s ease;
}

.hotspot:active{
  transform: scale(.99);
}

.hotspot.debug{
  background:rgba(124,255,210,.10);
  border-color:rgba(124,255,210,.35);
}

/* =========================
   Hint (debug)
========================= */
.hint{
  position:absolute;
  left:10px;
  bottom:10px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  padding:8px 10px;
  backdrop-filter: blur(8px);
}

.hint-title{
  font-weight:900;
  font-size:12px;
  margin-bottom:2px;
  opacity:.95;
}

.hint-text{
  font-size:11px;
  color:var(--muted);
}

/* =========================
   Map overlay
========================= */
.map-overlay{
  position:absolute;
  left:12px;
  right:12px;
  bottom:12px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.12);
  border-radius:16px;
  padding:10px 12px;
  backdrop-filter: blur(8px);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.map-title{
  font-weight:900;
  font-size:14px;
}

.map-sub{
  font-size:11px;
  color:var(--muted);
  margin-left:auto;
  margin-right:10px;
  white-space:nowrap;
}

/* =========================
   Scene + Log
========================= */
.scene{
  position:absolute;
  left:12px;
  right:12px;
  top:12px;
  bottom:90px;
  display:grid;
  grid-template-columns: 1.1fr .9fr;
  gap:10px;
}

.scene-media{
  border-radius:18px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.35);
  box-shadow: 0 10px 22px rgba(0,0,0,.35);
  display:flex;
  align-items:center;
  justify-content:center;
}

.media-placeholder{
  width:100%;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  letter-spacing:.14em;
  color:rgba(255,255,255,.60);
}

.scene-meta{
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  padding:10px 10px;
  display:flex;
  flex-direction:column;
  gap:8px;
  backdrop-filter: blur(10px);
}

.scene-title{
  font-weight:900;
  font-size:14px;
}

.scene-desc{
  font-size:12px;
  color:var(--muted);
  line-height:1.35;
  flex:1;
}

.scene-actions{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}

/* Log */
.logwrap{
  position:absolute;
  left:12px;
  right:12px;
  bottom:12px;
  height:74px;
  background:rgba(0,0,0,.40);
  border:1px solid rgba(255,255,255,.10);
  border-radius:16px;
  backdrop-filter: blur(10px);
  overflow:hidden;
}

.loghead{
  height:24px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 10px;
  border-bottom:1px solid rgba(255,255,255,.08);
}

.logtitle{
  font-weight:900;
  font-size:12px;
}

.log{
  height:50px;
  padding:6px 10px;
  overflow:auto;
  font-size:11px;
  color:rgba(255,255,255,.85);
  line-height:1.25;
}

/* =========================
   Matchbar
========================= */
.matchbar{
  position:absolute;
  left:12px;
  right:12px;
  bottom:92px;
  height:36px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

.matchbar-left{
  display:flex;
  align-items:center;
  gap:6px;
  flex-wrap:wrap;
}

.matchbar-right{
  display:flex;
  align-items:center;
  gap:8px;
}

/* =========================
   Panel (Result/Total)
========================= */
.panel{
  position:absolute;
  inset:12px;
  background:rgba(0,0,0,.35);
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  backdrop-filter: blur(12px);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.panel-head{
  padding:10px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  border-bottom:1px solid rgba(255,255,255,.08);
}

.panel-title{
  font-weight:1000;
  font-size:14px;
}

.panel-actions{
  display:flex;
  align-items:center;
  gap:8px;
}

.panel-body{
  padding:10px 12px;
  overflow:auto;
}

.tables{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.tablebox{
  background:rgba(0,0,0,.25);
  border:1px solid rgba(255,255,255,.08);
  border-radius:16px;
  overflow:hidden;
}

.boxtitle{
  padding:8px 10px;
  border-bottom:1px solid rgba(255,255,255,.08);
  font-weight:900;
  font-size:12px;
  color:rgba(255,255,255,.90);
}

.table{
  padding:6px;
}

.table table{
  width:100%;
  border-collapse: collapse;
  font-size:11px;
}

.table th, .table td{
  padding:6px 6px;
  border-bottom:1px solid rgba(255,255,255,.07);
  text-align:left;
  white-space:nowrap;
}

.table th{
  color:var(--muted);
  font-weight:800;
}

.table tr:last-child td{
  border-bottom:none;
}

/* =========================
   Buttons / Chips
========================= */
.btn{
  appearance:none;
  border:none;
  cursor:pointer;
  padding:10px 12px;
  border-radius:14px;
  background:rgba(255,255,255,.07);
  color:var(--txt);
  font-weight:900;
  letter-spacing:.02em;
  border:1px solid rgba(255,255,255,.10);
  transition:.12s ease;
}

.btn:hover{
  background:rgba(255,255,255,.10);
}

.btn:active{
  transform: translateY(1px);
}

.btn.primary{
  background: linear-gradient(180deg, rgba(124,255,210,.95), rgba(124,255,210,.70));
  color:#05150f;
  border-color: rgba(124,255,210,.85);
}

.btn.primary:hover{
  filter:brightness(1.03);
}

.btn.tiny{
  padding:6px 8px;
  font-size:11px;
  border-radius:12px;
}

.chip{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  font-size:11px;
  font-weight:900;
  color:rgba(255,255,255,.92);
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.10);
}

/* =========================
   Modal
========================= */
.modal{
  position:absolute;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:50;
}

.modal.is-open{
  display:flex;
}

.modal-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.55);
}

.modal-card{
  position:relative;
  width:min(92%, 520px);
  border-radius:20px;
  background:rgba(15,15,20,.95);
  border:1px solid rgba(255,255,255,.10);
  box-shadow: 0 20px 60px rgba(0,0,0,.55);
  overflow:hidden;
}

.modal-head{
  padding:10px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  border-bottom:1px solid rgba(255,255,255,.08);
}

.modal-title{
  font-weight:1000;
  font-size:14px;
}

.modal-body{
  padding:10px 12px;
  display:flex;
  flex-direction:column;
  gap:10px;
}

.modal-media{
  height:180px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.35);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:1000;
  letter-spacing:.14em;
  color:rgba(255,255,255,.55);
}

.modal-text{
  font-size:12px;
  color:var(--muted);
  line-height:1.35;
}

.modal-foot{
  padding:10px 12px;
  border-top:1px solid rgba(255,255,255,.08);
  display:flex;
  justify-content:flex-end;
}

/* =========================
   Loading
========================= */
.loading{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:10px;
}

.spinner{
  width:32px;
  height:32px;
  border-radius:999px;
  border:3px solid rgba(255,255,255,.20);
  border-top-color: rgba(124,255,210,.95);
  animation: spin 1s linear infinite;
}

@keyframes spin{
  0%{ transform:rotate(0deg); }
  100%{ transform:rotate(360deg); }
}

.loading-text{
  font-weight:900;
  color:var(--muted);
  font-size:12px;
}

/* =========================
   Footer
========================= */
.footer{
  width: min(96vw, calc(var(--w) + 24px));
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.08);
  box-shadow: var(--shadow);
  border-radius: var(--radius);
  padding:8px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

/* =========================
   Responsive tweaks
========================= */
@media (max-width:520px){
  :root{
    --w: 360px;
    --h: 560px;
  }
  .scene{
    grid-template-columns: 1fr;
  }
  .matchbar{
    height:auto;
    bottom:92px;
    flex-direction:column;
    align-items:stretch;
  }
  .matchbar-right{
    justify-content:flex-end;
  }
}
